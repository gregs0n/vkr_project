# vkr_project

## Общее описание
Данный проект представляет собой реализацию численного решения задачи сложного теплообмена в системе теплопроводящих стержней квадратного сечения. При этом преполагается, что теплообмен с внешней средой, а также между стержнями, происходит по закону излучения Стефана-Больцмана для абсолютно черного тела:
```math
\begin{gather*}
\begin{cases}
	- \lambda \Delta u = f, (x,y) \in G \\
	\lambda \dfrac{\partial u}{\partial n} + \sigma |u||u^3| = g, (x,y) \in \partial G.
\end{cases}
\end{gather*}
```

## Описание разностной схемы
Разностная схема (`class BalanceScheme`) построена по методу баланса для задачи с краевым условием 3-го рода, а затем в краевом условии $\sigma u$ была заменена на $\sigma |u||u^3|$. Получившаяся нелинейная задача сводилась к линейной посредством линеаризации по Ньютону и последующим решением СЛАУ с помощью стабилизированного метода бисопряженных градиентов (`BiCGstab`). Для задач с большой сложностью возможна "пристрелка" - использование решения той же задачи на более грубой сетке в качестве начального приближения.

# Как пользоваться

## Структура проекта (описание файлов)
1. Файл `scheme.py` - Содержит в себе класс разностной схемы.
2. Файл `boundary.py` - Содержит в себе некоторые тестовые функции, а также возможности для их генерации.
3. Файл `enviroment.py` - Содержит именованные кортежи (`namedtuple`) `Tests` и `Material` для описания тестового объекта и материала соотвественно.
4. Файл `tests.py` - Описывает некоторые тесты, используемые для оценки работы РС.
5. Файл `main.py` - Запускает тесты из файла `tests.py`.
6. Директория 'custom_numerics/` - Содержит самописный таймер для измерения времени вычислений и функции для упрощения построения графиков.

## Описание параметров конструктора класса `BalanceScheme`

Заголовок конструктора класса:

```python
def __init__(self,
             F: np.ndarray,
             G: np.ndarray,
             material: Material,
             limits: list,
             cells: list,
             cell_size: int,
             name: str):
```
1. `F: np.ndarray` - Сеточная функция внутренних тепловых источников имеют тип `Numpy.ndarray(shape=(cells[0], cells[1], cell_size, cell_size)`.
2. `G: np.ndarray` - Сеточная фукнция внешних источников, во внутренней области рава 0. Тип и размерность аналогично `F`.
3. `material: Material` - Вещество стержней. Характеризуется коэфициентом теплопроводности `Material.thermal_cond` $\frac{Вт}{м \cdot К}$, `Material.tmax` - максимальной температурой (указывается температура плавления), `Material.tmin` - минимальная температура, рассчитанная экспериментально, когда на одной границе области задается внешний поток, соотвествующий `Material.tmax`, а в `Material.tmin` записывается значение решения на противоположной стороне.
4. `cells: list` - количество стрежней в области.
5. `cell_size: int` - Количество интервалов разбиения внутри стержня.
6. `limits: list` - Размерность области: [0, limits[0]] $\times$ [0, limits[1]]

## Запуск вычислений

Вычисления запускаются методом `BalanceScheme.Compute(eps: np.float64, u0: np.ndarray)`, где `eps: np.float64` - точность, с которой ищется решение. Ошибка вычисляется по Лебеговой норме в $L_2$ приращения итерации по Ньютону, а `u0: np.ndarray` - начальное приближение, причем, если размерности `self.U` и `u0` не совпадают, то происходит линейная интерполяция с помощью `scipy.interpolate.LinearNDInterpolator`.
